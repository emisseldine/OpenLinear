import numpy as np
import matplotlib.pyplot as plt

points = np.array([[ 0.6346537948227042, -0.25053562659185047],
                   [ 0.677482051626668, -0.25296380366915916],
                   [ -0.7791595857739424, 0.23760724255103366],
                   [ -0.5909457523205168, 0.3487101286181235],
                   [ 0.8538781921601739, -0.3702299695370685],
                   [ -0.9944170483898203, 0.08040256720144294],
                   [ 0.4571303871766239, -0.23262567281205726],
                   [ -0.4841438547754622, 0.3472664779319218],
                   [ 0.9434415714226103, 0.0106465173669993],
                   [ -0.542837060942934, 0.4992369861078745],
                   [ -0.40943240717992047, 0.4020463416537233],
                   [ 0.8583263688875891, -0.21821908732245784],
                   [ -0.141634762266176, 0.36882909631722965],
                   [ -0.8016578551786964, 0.23585100781271132],
                   [ 0.369802248755279, -0.23751503577520958],
                   [ 0.9963867418179997, 0.14823506573037032],
                   [ 0.30928234484691575, -0.16613379395315966],
                   [ -0.9314590908474867, 0.04886393519607658],
                   [ 0.393351373219192, -0.3808365577927598],
                   [ 0.7478351989636027, -0.4657281463956966],
                   [ 0.07185210371724637, 0.5100330137560968],
                   [ 0.23393058529595567, -0.003910071478710579],
                   [ 0.3610459324449966, -0.33735441397824173],
                   [ 0.40760774470612704, -0.31077224847612395],
                   [ -0.24633269156333704, 0.25251391628770137],
                   [ -0.7393074565130342, 0.3277774483713316],
                   [ -0.31693989656866317, 0.6218564366245283],
                   [ -0.7908274366516268, 0.23195878014443544],
                   [ 0.8669657070760075, -0.11729116711916279],
                   [ -0.6246953488252227, 0.40234053608162645],
                   [ 0.8137286572006055, -0.16942211566980347],
                   [ -0.0550424555796738, 0.389963499711791],
                   [ 0.9801241110732934, 0.07321001924872277],
                   [ -0.6966741859919643, 0.31518538910282035],
                   [ 0.5359743639045458, -0.31955886517839693],
                   [ 0.2997658924706623, -0.1637681271068467],
                   [ 0.3418205470262128, -0.14924825835791464],
                   [ 0.18550409928829237, 0.049907958513582644],
                   [ 0.7796586496969409, -0.2052604998741611],
                   [ -0.33493957470787916, 0.537876185320871],
                   [ 0.20768534014154172, -0.05284916663905333],
                   [ 0.6129074460101556, -0.3681418479013923],
                   [ -0.4651233158570889, 0.5095585963938633],
                   [ -0.26625262878768274, 0.38375682844880415],
                   [ -0.4579746847107178, 0.27268181612281883],
                   [ -0.26455018473300806, 0.21969679718209004],
                   [ 0.29581045365098757, -0.06204118842746559],
                   [ -0.7519910329774133, 0.37790843891608666],
                   [ -0.5982576600656602, 0.324315948335497],
                   [ -0.03314971012528978, 0.2549162114626849],
                   [ -0.7250577060761227, 0.36098822310880246],
                   [ 0.9631861930711778, -0.08876818213584814],
                   [ -0.2525465044689639, 0.3952322923938695],
                   [ -0.17309577680287513, 0.41334401492643996],
                   [ 0.570809152976814, -0.4009342163588901],
                   [ -0.9758674376474523, 0.13788854761534936],
                   [ -0.5740652103330386, 0.43588379897752816],
                   [ -0.8008575034828518, 0.34661356453713044],
                   [ -0.9825902026542304, -0.06495540175311422],
                   [ -0.45442074242760455, 0.31728145928560114],
                   [ 0.12766892758713388, 0.28446409893585956],
                   [ 0.4579981468324392, -0.29997350400632056],
                   [ 0.8294259009031859, -0.15328010131617636],
                   [ -0.416905695293466, 0.33244216281510064],
                   [ 0.9088245801644188, -0.22392709754623558],
                   [ -0.15720152682735078, 0.368451290715276],
                   [ -0.16503536707148347, 0.49428955292818233],
                   [ -0.15576753448138247, 0.3526931766570659],
                   [ -0.16221683027601075, 0.6214098101071567],
                   [ 0.44800098814734035, -0.2784354524078542],
                   [ -0.7411694027647413, 0.45264329552317334],
                   [ -0.37916610304658005, 0.2998017848855355],
                   [ 0.8091043688270065, -0.3140438981230005],
                   [ -0.8700065082606239, 0.1814806078199537],
                   [ 0.4338328295837752, -0.30245285414079964],
                   [ -0.2851708232496737, 0.35599011118517615],
                   [ 0.19562509103187264, -0.049190377639238045],
                   [ -0.050895713693614786, 0.3984179181120443],
                   [ 0.5502705000397128, -0.4849484405372714],
                   [ 0.3550318076386314, -0.1476043010473272],
                   [ 0.3751545125444873, -0.4535170295993656],
                   [ -0.17414025562037927, 0.31513711174629616],
                   [ 0.5139850527062921, -0.3098857986976652],
                   [ 0.9661624926222017, 0.01538622945643739],
                   [ -0.9326152031852553, -0.03923169448937827],
                   [ 0.42108257203338373, -0.08813764797443613],
                   [ -0.9281416821244868, 0.11570223661160543],
                   [ -0.16196199201788608, 0.1004782947858848],
                   [ -0.6557592797774734, 0.4477940929855059],
                   [ -0.5840769260684398, 0.3645078611326393],
                   [ 0.46451445751572895, -0.33620992829874136],
                   [ 0.25619056026045706, -0.19757152932909636],
                   [ -0.21112199336703164, 0.09961457506527782],
                   [ 0.18539368894280006, -0.08970091758499478],
                   [ 0.761727291300472, -0.35852452464413276],
                   [ -0.679051243342232, 0.31369084063872116],
                   [ -0.15106789531779485, 0.12389613147139436],
                   [ 0.1356850644171288, -0.1535799948451002],
                   [ 0.1205872142507387, -0.07450586531804422],
                   [ 0.590704850786963, -0.2628665652730874]])
x = points[:,0]
y = points[:,1]

A = np.vander(x,3+1)
f = np.linalg.lstsq(A,y, rcond=None)[0]

#Compute Polynomial Interpolates
degrees = [3,7,13,23]
polys = []
for n in degrees:
    polys.append(np.polyfit(x,y,n))
    
#Compute RMS error
for g in polys:
    print(np.sqrt(np.mean((y-np.polyval(g,x))**2)))

#Graph Scatterplot
plt.ion()
plt.scatter(x,y)
plt.show()

#Graph Polynomials
t = np.linspace(-1,1,num = 100)

 #f and polys[0] have the same graph
cubics = [f,polys[0]]
for i in range(2):
    plt.subplot(1,2,i+1)
    plt.axis([-1,1,-0.7,0.7])
    plt.scatter(x,y)
    plt.plot(t, np.poly1d(cubics[i])(t), 'r')
plt.show()

 #Graph polys
for i in range(len(polys)):
    plt.subplot(2,2,i+1)
    plt.axis([-1,1,-0.7,0.7])
    plt.scatter(x,y)
    plt.plot(t, np.poly1d(polys[i])(t), 'r')
plt.show()
