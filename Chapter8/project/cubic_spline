import numpy as np
import matplotlib.pyplot as plt

def lstsq_constraint(A, b, C, d):   #|Ax-b|^2 is the objective to minimize
    ATA = A.T @ A                   #subject to the constraint Cx=d
    CT = (C.T).reshape((len(ATA), -1))
    p = len(CT[0])
    KKT = np.block([[2*ATA, CT], [CT.T, np.zeros((p, p))]])
    KKTb = np.hstack((2*A.T @ b, d))
    return np.linalg.solve(KKT, KKTb)[:-p]

n = 3 #degree of polyonmial
M = 100 #number of data points per third

x = np.array([-2.9156484518528263, -2.5296593302643755, -2.631044397919176, -2.6515818644758142, -2.6416812479095024, -2.520462171333036, -2.7018608650235056, -2.819395611718881, -2.0287274570587632, -2.4897654365077218, -2.4969260741915806, -2.3713977377804243, -2.864227512976914, -2.549483488703254, -2.8976587347054767, -2.6530901407983967, -2.3573726100673467, -2.184562580994521, -2.9528445443996794, -2.4169151181250315, -2.677930091706391, -2.955374039359311, -2.9097675860961485, -2.1655500530182046, -2.1619029866172763, -2.228416066981837, -2.2619708007095105, -2.6584813874261335, -2.8812024010534394, -2.000779837339586, -2.4737160184584335, -2.959532847311022, -2.0508883726115386, -2.7634966042433735, -2.6111200009720723, -2.0237330369620428, -2.979313708343321, -2.9866865608307434, -2.6297781701928438, -2.6385110226411217, -2.9451449611760796, -2.152928936323259, -2.995109835913908, -2.0716608691961795, -2.2371023544262245, -2.6958961087098556, -2.553488931680258, -2.660955347054108, -2.1490702952749086, -2.0126117383742343, -2.7536462777359665, -2.8415773527293737, -2.999752779467846, -2.157239119782135, -2.423522156807415, -2.8763266637158216, -2.0272110872422733, -2.4401284521258644, -2.532749778470484, -2.5770245818205972, -2.6700301330972254, -2.1809363620010553, -2.882776108815796, -2.5492167409610484, -2.934995086557871, -2.456756291799827, -2.724519865220445, -2.433604470412325, -2.7369855144937265, -2.363045320542661, -2.8035918044995656, -2.855502517404159, -2.229028247156497, -2.8244535169079525, -2.470728674144849, -2.698264748140205, -2.6797187361960173, -2.945092835003935, -2.4054937822159994, -2.987638856485106, -2.229398732874435, -2.4460811068326294, -2.3398646233647344, -2.942823829998823, -2.27118719664702, -2.9845908403537895, -2.61977805783674, -2.829200788524095, -2.947853099564016, -2.8622908621277183, -2.275716758188644, -2.318714914511645, -2.3403708590001857, -2.6143467533406826, -2.6470512531970574, -2.894705168490455, -2.279198639800631, -2.4738699644047015, -2.814057040596388, -2.5349642443351255, -1.0007826673972346, -1.2892097158972056, -1.7313801256663393, -1.0457494205832365, -1.2571663270497173, -1.9018421355758692, -1.3344952970445185, -1.3992533000069907, -1.32602976484032, -1.1854111675934091, -1.7310505748294103, -1.8369260487595735, -1.9295586150169606, -1.5998790289241387, -1.9620065685672177, -1.096789325726501, -1.8197194143065683, -1.6568319191476557, -1.7327395826665049, -1.8596941770619602, -1.8492968398590066, -1.7338156491841201, -1.4566416424250854, -1.7400190477150854, -1.6446060545454797, -1.6250065320815463, -1.2122461162146374, -1.5160561449685765, -1.6126150188182882, -1.9520648733787946, -1.0153402685652035, -1.9169657797011872, -1.4372339423194007, -1.0959677172487985, -1.6032536652804645, -1.320129471746955, -1.7866448899296161, -1.5678358953010014, -1.0719523448818622, -1.0403066393880143, -1.8099319999185006, -1.9891531373262406, -1.9099612682782574, -1.7716620720791614, -1.5180830683023365, -1.3674055276383361, -1.5110111921761407, -1.6985631793153853, -1.8107813920156715, -1.8234888591184446, -1.0656003737384014, -1.886511427381552, -1.8368143777561037, -1.5928178866485956, -1.592484851042298, -1.0420894737706754, -1.1308218705418425, -1.809075214578201, -1.5075073926366676, -1.7975053525239382, -1.6741221240214366, -1.568196986317727, -1.597164451411608, -1.7078964805388797, -1.6579359214054294, -1.6741016710252472, -1.1711873543035343, -1.9360589627435218, -1.824627193635192, -1.5511813318371348, -1.57368470330846, -1.8384193226804415, -1.4708029671593001, -1.8258932363556708, -1.3906631204501405, -1.2016851445343526, -1.4069185030802096, -1.1279066424794855, -1.8258548900684772, -1.7928683787656612, -1.6178198019715921, -1.3063341797905776, -1.6829103736488014, -1.2037344136318326, -1.9354591585818184, -1.6895508008955709, -1.6160699255274613, -1.453748006796062, -1.8814942805218813, -1.6015585085875794, -1.0024764381326514, -1.2364082294294918, -1.9049238550618957, -1.0280336250996416, -1.4350946526818074, -1.9866608071414429, -1.8245981050512556, -1.2707161739856865, -1.232595852053707, -1.6409811911975396, 0.8851062306909551, 0.8236431442286503, 0.5421826729458141, 0.8644117932420452, 0.3624371272573905, 0.9616397062700016, 0.3866182583842348, 0.5661836671838834, 0.9617595042393061, 0.7980241123184593, 0.468409425444567, 0.07804122183852846, 0.4335613246720764, 0.284827240321575, 0.8193878829363724, 0.02842838441994533, 0.7227594630265692, 0.5654083904950183, 0.10071413311793076, 0.3846693586828568, 0.9299018041382312, 0.013885478159460507, 0.4365924842086871, 0.7165067878429301, 0.7261146465088479, 0.22992515076874265, 0.5236696043736436, 0.012365523254085797, 0.13859585316048328, 0.6102550932313986, 0.21487530601028415, 0.7189599894222323, 0.2073334420928049, 0.2548460709490872, 0.7159654230368648, 0.19619896161174055, 0.6120989660640557, 0.6547525020083191, 0.13887629702410298, 0.7574467028794605, 0.5755249455583847, 0.4046816505403815, 0.43845906887004527, 0.8595743424395363, 0.08374178896971285, 0.7092028255537796, 0.26379409149974065, 0.41655787273932987, 0.6112110481078933, 0.053919226490375505, 0.13115415433298894, 0.227195630837575, 0.09413654190350418, 0.27592159316460774, 0.08491769652937298, 0.3406624645446592, 0.6075400058552594, 0.6359229169128385, 0.0097054191019037, 0.910866801392788, 0.7817643624072909, 0.7448920157815503, 0.8418660310443197, 0.8374554062131623, 0.423875695246113, 0.8880274047443273, 0.548989154286351, 0.16545584169429728, 0.725312872501742, 0.15212543857170746, 0.2994984602595401, 0.9614718399185824, 0.7872468682504211, 0.07141651188904685, 0.48138752132510154, 0.1024127225923992, 0.9278862754642324, 0.5458787035575924, 0.004060261964226375, 0.7632334760509804, 0.4323660611455785, 0.37848056604172164, 0.2384211435826994, 0.09167988004029337, 0.9590127323455896, 0.6001651301829792, 0.47700568157755074, 0.34502731731482217, 0.494260366653164, 0.6247012421609742, 0.9602826101076124, 0.2576804127416731, 0.6509247207051931, 0.9090535800811191, 0.6356650452228062, 0.48033573974971944, 0.8500377707301138, 0.8344274427399369, 0.9375294076688617, 0.6069501904628484, -0.33905251530415237, -0.460738263535036, -0.04440012172051033, -0.351448460352348, -0.7365319733402663, -0.24528501294376137, -0.5480661777405076, -0.16284584906411947, -0.07501964025692331, -0.7509245874717622, -0.12781498596614627, -0.6361224679509244, -0.21650911942435758, -0.11867405288439925, -0.4667472719831398, -0.8150973000005601, -0.22048960210496615, -0.6139226552201554, -0.6966332045149949, -0.30955149345670585, -0.6316985966729333, -0.7626976206971929, -0.5346296111641989, -0.6197571161451051, -0.5279466213760242, -0.33574343084978586, -0.10315196047367081, -0.8732659372863433, -0.11088747548662037, -0.8978184504703861, -0.21457684936171373, -0.986685931287742, -0.7168224136466138, -0.4761137706797045, -0.9467887307719621, -0.07216562839608665, -0.5171217265441295, -0.478620841586356, -0.6419886637949674, -0.5579771675823754, -0.16415007162285367, -0.06821694303028114, -0.829083108110889, -0.3451815861590758, -0.28201369909355645, -0.23606420051731425, -0.5143493866413196, -0.7859136055391255, -0.3092711031322962, -0.3491483905635069, -0.9600076116903716, -0.023401868271259563, -0.7574691770647445, -0.5701358148898916, -0.5143515578972382, -0.8886814756165626, -0.8623972943553775, -0.782591195932774, -0.3115858647805191, -0.6253795387073282, -0.5510139536260525, -0.9987998340892804, -0.4613537181604257, -0.295652778033601, -0.07885691341491896, -0.47374287755715083, -0.7779249940863204, -0.4846935805927466, -0.8603551311680963, -0.7581933320992961, -0.7259860065428169, -0.7839081059279708, -0.23579990694793695, -0.8154270594548221, -0.006148890095386106, -0.27355851218428795, -0.9944668349110306, -0.3019339470151726, -0.9434559968079403, -0.9286003588398438, -0.5397020246528181, -0.8806933173937944, -0.20763928803708764, -0.5181290150381801, -0.528031922762495, -0.648939244933344, -0.96726433774176, -0.5864677229689546, -0.9940966430800249, -0.3098651650962747, -0.6138256443888124, -0.5888598407107127, -0.27260726247697786, -0.2407439916690478, -0.8600244414732202, -0.4393175068655901, -0.2903255534262711, -0.6418702629285173, -0.650071938367814, -0.10193995285878266, 1.5603453639428935, 1.0481192902401848, 1.7723960146346338, 1.2478845066520332, 1.9600449731344733, 1.2627612561513892, 1.9312319633682096, 1.9564121174174451, 1.6774885787559302, 1.1208962149416917, 1.799515305102727, 1.2216539290057793, 1.6923154844866286, 1.4080824674011707, 1.759081316234333, 1.1483234122462715, 1.4001858196382595, 1.7863592982562317, 1.4312475677867214, 1.5142867016394295, 1.8723203766444447, 1.5479333214385669, 1.8173166006421149, 1.208334254755135, 1.7277877674789504, 1.9892249621903777, 1.3474901105619952, 1.1811554168016607, 1.556511151695852, 1.5774648531387978, 1.7741719400584024, 1.7899845234443892, 1.5810598715443112, 1.9812854331315615, 1.5565192837510484, 1.1402048243944338, 1.2174881086970006, 1.4180174486194899, 1.550012716814142, 1.8844493835691347, 1.22293452325232, 1.479231861447637, 1.1886297874705731, 1.2140654503367168, 1.7551014330350192, 1.421989970107758, 1.9611585764979456, 1.5783898133693306, 1.3500926507481217, 1.7945322734596698, 1.2855079797227968, 1.1068502502253086, 1.3778025759634183, 1.5948479708139232, 1.2810332137449292, 1.0843148532120988, 1.9339614857524323, 1.073582905799713, 1.6165389698249304, 1.7843751976837736, 1.9381797195414474, 1.8894762122874085, 1.5333905029974053, 1.1319827099178474, 1.2663469201297874, 1.801191793398013, 1.278552320103981, 1.3854613317926912, 1.4058639669776039, 1.3567683524030836, 1.13707625383707, 1.5625059237181858, 1.9304942719237626, 1.3010385488534726, 1.687305075799548, 1.7589930277257275, 1.4506526945108624, 1.2159837282783963, 1.425461220131511, 1.196474315780241, 1.7038470159945422, 1.4894427832330912, 1.2426205864374011, 1.681734534885885, 1.7209843159647198, 1.0397661180187865, 1.3366678470727682, 1.9044646478712755, 1.1796689900548594, 1.3907366292627015, 1.0777452995803432, 1.1839211298147814, 1.543398353164966, 1.4935925986623129, 1.9996633943562236, 1.077338913608774, 1.2116318449605883, 1.5535176823522319, 1.1894985519520764, 1.3014141598740872, 2.231932326243987, 2.661167991213264, 2.4097571316335937, 2.4774066898616534, 2.0054247722199183, 2.318016630971109, 2.6720871416032974, 2.9323243729794566, 2.488587477649061, 2.1696971155748033, 2.8609759233898804, 2.721178525424193, 2.162469217939745, 2.419358241240899, 2.4378097279450808, 2.214633371057613, 2.8235195195190217, 2.507295683828621, 2.846112310908361, 2.7797346327434296, 2.778409912368324, 2.0450843606608315, 2.5003197111760347, 2.0820798646518393, 2.6745538686665826, 2.6569640152326484, 2.605994406145368, 2.624637074690571, 2.769963426238162, 2.7805015496842027, 2.956049894429842, 2.4706445675633404, 2.390336321347823, 2.555966751939798, 2.375007838293091, 2.5135421760906915, 2.698504287822184, 2.0896666903705943, 2.8371398310954965, 2.1805043860734625, 2.5252691269830763, 2.450862381790288, 2.2500169411714275, 2.2424904173501785, 2.4136511949955004, 2.0244064127770205, 2.572332205070401, 2.3713718297045987, 2.6672334907907707, 2.658417017633777, 2.5947672368493975, 2.397614272606495, 2.178411228927642, 2.443268313919658, 2.8128471147397383, 2.2489735520561815, 2.6190186033387066, 2.3227380342922586, 2.5431655469536896, 2.8682299958329986, 2.1305076688695492, 2.8272790191253474, 2.6189004768461657, 2.490848902184088, 2.2370731429115986, 2.3493271162464477, 2.838652377853139, 2.1679679887328933, 2.5353101369460553, 2.438111404580175, 2.7074644639567103, 2.2531645171272636, 2.8915520895161455, 2.3220541277982503, 2.952495144605952, 2.0652306779377634, 2.361727450350817, 2.424574793351765, 2.2094389365887084, 2.596664740011544, 2.5549801585111114, 2.6048455669550683, 2.015386292458082, 2.365004739571165, 2.0065048823701406, 2.573982658202202, 2.1378310570976495, 2.884201339827163, 2.165471054678409, 2.363083431561415, 2.810835811229279, 2.374022202932614, 2.5035797071947115, 2.83662301441472, 2.2483701215702534, 2.0413533750331214, 2.6176020914532216, 2.7379929534215, 2.0639360656596555, 2.510192558739786])
y = np.array([-15.39496812059651, -8.229505821373793, -10.006162297976992, -10.818165404698382, -13.30785153142777, -10.85180744185432, -12.558209594592334, -11.737612160853658, -6.136274411123057, -10.76294608489899, -6.914816615232441, -8.925338530445531, -12.48260075797293, -10.883285138037161, -14.36321661806393, -10.020222141092642, -7.963966464549246, -4.693537952483947, -15.834358982401426, -12.372955248644043, -11.110418437799447, -13.310026110350233, -14.437989131143665, -7.473854064909, -6.4713628501001415, -6.857876908947124, -5.0660205796301, -9.0502958114489, -17.29709463622448, -2.9505652417864567, -12.107934387510406, -10.022872071740142, -5.173408591334012, -12.464610328902658, -9.69796729839424, -4.665955790891194, -16.577535710460882, -14.046961278457903, -11.31429182730055, -11.219454797608607, -11.783397712709643, -1.9101839876301634, -17.19840467458404, -4.8693120337797895, -7.112391619549578, -10.352550887311722, -12.59894624702877, -8.363436328603173, -7.399993730702645, -8.9981064419446, -9.351607760096435, -13.656151292497027, -15.278348330412719, -5.470879410678251, -8.08622120686694, -11.2029940919182, -10.030368917442466, -8.263166219666745, -7.739164849816037, -10.501229561328831, -10.890047323954299, -5.497017971485393, -14.701580672980892, -8.422516990009578, -11.387113555365243, -7.579970403185557, -13.465840494800634, -9.733402172304638, -10.533571587460088, -4.169854419472555, -11.553888049743748, -10.218265281171293, -8.160435739255831, -11.793134761480083, -11.638443078146176, -11.264581592021463, -11.552962060826488, -13.771425937177025, -6.733241330908289, -12.831475851153707, -6.763599709060345, -6.2832811043674655, -8.347942495985704, -11.197917774592758, -6.7706604238136805, -12.5867510029047, -9.363008827234038, -15.034860266701804, -14.767799844612563, -12.44623162646987, -7.040553083736338, -5.992583599149325, -9.505616999946596, -7.981222795803648, -12.049216066813138, -14.576563627163228, -4.345026073004732, -9.433032296889339, -10.96519707192704, -7.959385589702614, 2.286688000218616, -0.8509133269714131, -1.7526458316104365, -3.1950196028887796, -3.480118777993623, -5.8953421725549475, 2.0895280277225483, 0.11011398200771882, -1.0487842619506031, -0.7586180563587884, 2.444951468860844, -3.549380103465694, -6.012305189565335, 2.127158009332229, -2.9738756544043294, -2.08589874538169, -4.103602623779473, 0.2351172449390111, -2.4483600703670065, -4.79120404508288, -1.9679588658762865, -5.342547358176308, -0.16778419466631922, 0.43108404158900715, -2.103347194855978, -0.17711384674389619, -1.6352057430665228, -2.5236626157818365, -6.649732739815175, -8.073700984293803, 0.9062043532117606, -2.7107955703195117, 1.9971921524348746, -1.8339062138712632, -4.18176685012827, -1.4152883725113343, -6.189459751197166, -2.7820555196632517, 1.7688224128266252, 0.5829623145096516, -5.129132617383856, -6.242651787998837, -7.967725359457471, -4.547466155906567, -6.614600242305146, -3.203453953457693, -0.008330344009429336, 1.9210296032465157, -2.687448083310093, -8.267973761820347, 0.9470265726133916, -4.368622967020551, -3.810607123209921, -3.330988442414986, 2.570534042591138, 1.3923088369716692, 1.8530893767030734, -5.706936244062467, -5.182581217332459, -3.2597538106055097, -2.4544111767947445, -1.4915416475227583, -6.275890486591172, -4.694779934454074, -0.6617331984259156, -2.0182944018971414, -1.4299812751537448, -6.662952183058843, -3.2276396941010734, -1.6604865988427986, -1.213263726341929, -1.4904711124476777, -1.0083532466963767, -4.397315110592517, 0.14703353907443062, 3.7576187967064962, -1.9573067006789286, 1.698849409071439, -3.301952622413255, -4.55806900121715, -0.2643161481471714, -0.6539140821743784, -4.713528313099214, -3.1952343185007352, -6.078388091698855, -0.19863885047939567, -3.720305813890203, 0.4389435873771399, -5.793454859534835, 1.261319199585747, 3.5167022861109465, -0.19121150487131655, -2.254269732520975, 1.1609257940566753, -1.3958416743134268, -8.15587155830027, -7.551541768978935, -0.581225697181851, 0.2709694977950796, -3.161344187878059, -5.43009097493961, 3.8047067443213933, -1.3570036452137517, -1.6630501423400628, -3.18097992754682, -4.536337588679173, 2.1231727500034765, -0.6702040986785032, 0.11378970555069712, -3.9440325734565924, 0.08053815147871646, -3.829942399381486, 0.9621643745511994, -1.1211214675241672, -0.5632411237998256, 1.513234361398297, -2.0403621950696382, -1.3861864395796935, 2.3446722488987524, -5.26794711975004, -5.717703330452339, 2.889126317615085, -2.9643519577669384, 0.19134634770618764, -3.148437422060346, -1.000492615038602, 0.7858427616935248, 2.914605961143011, -0.07289830313563789, -2.6542198844852467, 0.8079942974834757, -0.41923749879653616, -2.6473173160819794, -2.026726168004261, -0.23929288566056783, -1.958233836194607, -4.565277995870695, -2.5750302336363777, -2.7838396608597167, -3.218178512305835, 0.20099294903386022, 0.12484471566984068, -0.6591228791592204, -1.2654709474591328, -2.668941246591835, -2.11725839295251, -2.5403425030561495, 0.37331495165256623, -0.5137898394000444, -2.0623881603256136, 0.8519662699650583, -2.5469725983676406, -2.8132114799599273, -0.18441050186802732, -3.0317864253102385, 1.8819971173490069, -5.848322456249187, -1.8709777830100072, 0.7636750709783112, -3.9667096204601404, 0.37957373791101734, -2.9594686947537867, -3.5242485653531093, -6.36633964709538, 3.133164939796268, -3.0207034215484, -1.990100264470579, -0.9932218095907909, -2.6675250826370567, 2.7144977416907, -2.5687598852669, -1.2274960526464993, -3.1306340019582115, 0.9677646345761752, -3.2055807586418528, -1.0556237844364342, 0.47471054695535475, -3.3121315288356437, -0.06668065018602654, -1.7217235287979045, -2.3149124554985727, 0.5253945028234326, -1.367439576298243, -2.4658621251413884, -3.0113577924439725, -4.723407362579772, -3.495985561835206, -0.999642897475831, -0.4270862818340011, -0.011472743712407585, -3.4198845759573344, 0.11091454491504349, -5.559860788470679, 0.28085215456346235, -3.0974641123973043, -0.28712691658051237, -3.9596190478547477, -6.339735652958819, -2.088901416207108, -1.417674595786808, -0.347026877510328, 2.0891130817214667, 3.7907639882171873, 0.9461898928641814, -0.9583998663933062, -1.1840878633845682, -0.5034346497485853, 0.8762658799085825, 0.9118141888358806, 1.655754021216154, 0.5662869090500551, 2.412131694472964, 0.8144735471780673, -0.033770838621309696, 0.3014652242909771, 2.182524341245189, 0.666628333942159, -1.1268433679383896, -0.6477603360699283, -0.35424430135037865, 1.957631421234638, 4.680220091907769, 2.115607725480407, 1.1430728744528522, -0.5894466706474697, 2.0409573240329726, 3.719858714911533, 2.6844239699830865, 1.036590236267029, 3.989993714548502, 0.18292674731877767, -1.7206920721210506, 0.9994464206166425, 1.1182649651331447, 0.512767180949234, -0.22290664916324612, 2.844502468607093, 3.1820269931700507, 1.0436690862249498, 1.6153360940836472, 1.4608495026129433, -3.959099193235654, 0.4465905044914888, 1.6588278036926782, 0.06759286116282082, -0.19051619024686273, 3.598471500698407, 3.2244827549161856, -2.6872327142313273, -1.6703675967450882, 2.255769355656735, -1.610059546611667, 1.2954841821620988, -0.30362396133315817, 1.4330814548287174, -3.616284753099987, -1.5318018490987915, 2.3077218045201615, 1.9012834995476755, 1.3054417972648065, -1.394286177648153, 1.5127908325901998, 3.121207040954017, -2.0672966929153, -1.5810481793644038, 1.5525057845664099, 0.04422301895380909, 2.961604100324984, 0.6063528591283215, 1.975283955877515, -0.8682051208196417, 1.6436184190318701, 2.6675362532482865, 3.29090369387505, 2.127382957037391, -0.002800603938726054, 2.3505030707923877, 0.8667397805444098, -2.113362212647823, 0.6556889830310425, 3.521181484454387, 0.116794176991877, 2.755694150748901, 5.78779911182135, -1.6052110661433199, -1.5270954400429844, -2.4135315520066434, 1.928233844903711, 0.35701662619840024, 0.41737061288330923, -0.8822010050165106, -1.0358215758845533, -1.6981758976047854, 1.9047273742599051, 3.305191056722614, 0.0966075887056097, -2.416060894093267, 4.710580008587732, 2.539785747293003, -0.19140236800398808, -11.599831074627424, -2.2868273170833824, -16.881363259988614, -8.1244633757844, -12.923281141040048, -9.215889912347306, -11.248169650764027, -11.42520426709477, -13.125821437279326, -6.544996408739598, -8.604670237184742, -7.0431595346035625, -10.766409795730969, -15.987127680666745, -15.940801770677027, -6.246638537573346, -8.732672294464345, -10.546938438580177, -8.08547730967308, -11.344763245380864, -8.284466150376886, -11.234356954133876, -11.346787630218728, -4.51957482206952, -11.42096820750745, -12.373548996533, -8.259400984654834, -1.7568675774890155, -10.661054319876856, -15.756117821586518, -11.60943318302196, -10.738962839131181, -9.052809244343647, -13.52088047784536, -10.039313839373875, -6.215596374340496, -3.8589455113415077, -7.283398816857671, -10.961222043739655, -16.01017477094978, -8.617305419795985, -9.35649352768569, -3.684903612279702, -6.263116625493419, -13.599250561051386, -9.949073159526701, -17.071154688716955, -14.396430429124951, -8.522103000267473, -12.117614616417018, -9.651520523627799, -7.376691775141312, -7.960852375485771, -8.651644393787386, -9.26616289625383, -7.153844988779632, -12.366353995058324, -5.285251911868948, -12.430373251199745, -13.815666940575676, -15.479391315552348, -14.267414053772178, -13.533985823992518, -5.802774398806888, -10.48969306899463, -7.946797032182446, -9.268305929167004, -11.055248202805977, -12.00787743490377, -13.20812760214325, -6.028911111208036, -10.266843620754313, -12.605101471237214, -8.188458750019944, -14.4462742826762, -10.357033713196802, -9.807364915281992, -6.155336772062291, -8.491938222822867, -8.210680940184515, -14.510100179337599, -9.3537536778336, -7.395050464581502, -13.089563969300526, -10.544816596533693, -4.0797202052358905, -9.537985435829407, -10.701905477997977, -6.773290788186362, -13.898229130738741, -1.5917713940105536, -7.329594663001116, -11.078339998115952, -10.47040669612004, -14.62671681214663, -7.683309133196834, -5.16628438249485, -11.489984604865514, -4.56770957951724, -9.029981327320707, -15.152807503856774, -7.1098716373795074, -8.87636209296124, -9.701181311634446, -11.780827434669602, -8.945355360150382, -7.473049362321666, 0.2976615678864034, -10.200085638050364, -11.43222867461158, 2.288591214501234, -1.3217305026352981, -9.093157879060808, -10.517101041092763, -4.43107180903991, -14.599738617589685, -3.716987848770571, -9.478290387619454, 0.07580984735294569, 0.9454857386966742, -2.7847049378412443, -13.701078193387033, -9.034726929110972, -12.547269052268552, -5.715142854181368, -5.542331428943917, -6.663820099980155, -6.693591824397444, -3.6048777256173237, -0.2691661350418746, 1.2631205120474789, -8.093574480105378, -12.632368903155495, -3.53528220690528, -7.896002301811731, -7.527823028685469, -0.9684406149862719, -11.435587926911573, -2.130765800586703, -14.152138131630611, -9.023140607071111, -8.943040685509022, -9.679517172221162, -13.138535374426533, -10.03465919649508, -13.32975758938473, -4.768110597008842, -11.948588052793855, -1.4877946027529858, -6.719700980087811, -2.6112873168250004, -9.189389644083024, -12.889075157716233, -4.494954887019628, -3.3231000784252704, -9.928706841594956, -7.35666224540031, -6.654857865321333, -5.085308787119811, 0.49444402811051436, -9.431076235654503, 2.1303722902628253, -6.951585553647272, -9.927988877423543, -13.268632469047759, -8.111182417781393, -1.1010389128711646, -11.457793044783005, -10.341872621434955, -8.463637138626723, -1.5704462228988816, -10.482160531205711, 0.6798320467318049, -13.69899637177125, 3.9396679838944375, -13.300093733637375, -9.665920988517419, -7.109340258022598, -12.38915917759352, -6.1443821023913285, -4.29798843346777, -6.092703796714556, -14.114771051214982, -11.990161001549609, -12.885256362838152, -7.454874853841421, -7.664007657627327, 7.328533147077765, -14.445613847500066, -12.269084023200584, 3.5889134179285804, -12.442467346816061, -7.520140500939043, 2.7890409637171736, -9.985467238349985, -10.69760077595194, -5.944113385299735, -1.7736004754461223, -14.132630193323745, -6.370339006541358])

xleft = x[:2*M]
xmiddle = x[2*M: 4*M]
xright = x[4*M:]

X = # construct the Coefficient Matrix HERE
D = # construct the Constraint Matrix HERE
    
# Solve constrained least squares problem Xc=y subject to Dc = 0
coeffs = lstsq_constraint(A,y,D,np.zeros(len(D)))


### Graph the Cubic Spline #####
plt.ion()
xpl_left = np.linspace(-3, -1, 2*M)
ypl_left = np.vander(xpl_left, n+1) @ coeffs[:n+1]
xpl_middle = np.linspace(-1, 1, 2*M)
ypl_middle = np.vander(xpl_middle, n+1) @ coeffs[n+1: 2*(n+1)]
xpl_right = np.linspace(1, 3, 2*M)
ypl_right = np.vander(xpl_right, n+1) @ coeffs[2*(n+1):]
plt.scatter(x, y, color ="gray")
plt.plot(xpl_left, ypl_left, 'r--')
plt.plot(xpl_middle, ypl_middle, 'blue')
plt.plot(xpl_right, ypl_right, 'y-.')
plt.show()
